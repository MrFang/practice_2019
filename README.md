# Практика 2019. Таблица DocumentTypes
## Web-интерфейс

Для того чтобы увидеть содержимое таблицы необходимо зайти на http://students.yss.su/PSTGU/2019/zolotukhin/documents/front.php?action=read

GET параметр action передавать **обязательно**, он указывает, какую страницу вы хотите увидеть. Существует 3 варианта этого параметра

* read
* update
* delete

Для параметров update и delete необходимо так же указать параметр id, который является идентификатором записи в таблице.

### Параметр action=read

Если параметр action равен "read", это значит, что вы хотите увидеть содержимое таблицы.

Вы увидите таблицу из шести столбцов

* Номер типа документа в таблице
* Название типа документа
* Описание документа. Может отсутствовать
* Указывает активен ли документ. Может принимать значения 1 или 0
* Ссылка на редактирование записи
* Ссылка на удаление записи

Также под таблицей будет отображаться форма добавления новой записи из трёх полей: name, description и active. Все поля кроме description обязательны для заполнения.

* Поле name: название типа документа
* Поле description (опционально): описание документа
* Поле active: Указывает, является ли тип документа активным. По-умолчанию равен true

После нажатия на кнопку "Add" запись добавится в таблицу.

### Параметр action=update

С этим параметром необходимо указывать параметр id. Если параметр action равен "update", это значит, что вы хотите отредактировать запись.

Вы увидите предзаполненную форму, содержащую те же поля, что и при добавлении записи. Данные в форме будут соответствовать текущим данным в таблице. После нажатия на кнопку "Edit" данные в таблице обновятся.

### Параметр action=delete

С этим параметром необходимо указывать параметр id. Если параметр action равен "delete" значит вы хотите удалить запись из таблицы.

Вы увидите запрос подтверждения удаления. Если вы хотите отменить операцию, перейдите на любую другую страницу (Например, нажмите кнопку "Назад" в вашем браузере). После нажатия на кнопку "Delete" запись будет удалена из таблицы.

## Исходый код

Исходный код состоит из трёх файлов: template.html, front.php, back.php.
Файлы снабжены документирующими комментариями.

### Файл template.html

Файл представляет из себя html-шаблон в который, в процессе рабоы программы вставляется данные страницы

### Файл front.php

Файл инициализирует базу данных, обрабатывает POST запросы на создание/обновление/удаление данных, предоставляет переменные и функции для отображения на странице

#### Обработка POST зпапросов

Производится проверка того, какое действие быо запрошено и вызывается соответствующая функция из файла back.php

#### Установка переменных среды

Вычисляется значение переменной page и на основании этого значения устанавлевается переменная title, которая является текстом заголовка. Кроме того на основании пеерменной page определяется код тела страницы

#### Функция `renderDocumentTable($conn)`

Функция получает всю информацию из базы и возвращает html таблицу соответствующую этой информации. Также возвращает ссылки на страницы добавления/обновления/удаления записи.

Параметры:
* conn: подключение к БД. Ссылка на объект, возвращённый функцией `mysqli_connect`

#### Функция `renderAddForm()`

Функция возвращает форму для добавления записи в таблицу

#### Функция `renderEditForm($conn, $id)`

Функция получает из базы информацию о записи c идентификатором `$id` и возвращает предзаполненную этой информацией форму для редактирования записи

Параметры:

* conn: подключение к БД. Сcылка на объект возвращённый функцией `mysqli_connect`
* id: идентификатор записи в базе

#### Функция `renderDeleteSubmitionForm($id)`

Функция возвращает форму, запрашивающую подтверждение на удаление записи с идентификатором `$id`

Параметры:

* id: идентификатор записи в базе

### Файл back.php

Файл предоставляет функции для работы с базой

#### Функция `getTypes($conn)`

Функция возвращает всю таблицу в виде массива ассоциативных массивов, каждый из которых соответствует одной записи в таблице

Параметры:

* conn: подключение к БД. Ссылка на объект возвращённый функцией `mysqli_connect`

#### Функция `addType($conn, $name, $description, $active)`

Функция добавляет новую запись с указанными параметрами в базу

Параметры:
* conn: подключение к БД. Ссылка на объект возвращённый функцией `mysqli_connect`
* name: имя нового типа документа
* description: описание нового типа документа
* active: флаг активности нового документа. Строка 'true' или 'false'

#### Функция `getTypeInfo($conn, $id)`

Функция возвращает ассоциативный массив, содержащий информацию об одной записи, с идентификатором равным `$id`

Параметры:

* conn: подключение к БД. Ссылка на объект возвращённый функцией `mysqli_connect`
* id: идентификатор записи

#### Функция `updateType($conn, $id, $name, $description, $active)`

Функция обновляет информацию о типе с идентификатором равным `$id`

Параметры:

* conn: подключение к БД. Ссылка на объект возвращённый функцией `mysqli_connect`
* id: идентификатор записи
* name: имя нового типа документа
* description: описание нового типа документа
* active: флаг активности нового документа. Строка 'true' или 'false'

#### Функция `deleteType($conn, $id)`

Функция удаляет тип с идентификатором равным `$id`

Параметры:

* conn: подключение к БД. Ссылка на объект возвращённый функцией `mysqli_connect`
* id: идентификатор записи